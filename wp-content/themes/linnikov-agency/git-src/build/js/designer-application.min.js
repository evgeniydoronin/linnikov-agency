(()=>{"use strict";(()=>{function t(t){if(t instanceof Element||t===window)return t;{const e=document.querySelector(t);return e||new Error("Cannot find the target by selector: ".concat(t)),e}}Number.prototype.clamp=function(t,e){return Math.max(t,Math.min(this.valueOf(),e))};const e={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerover:"MSPointerOver",pointerout:"MSPointerOut",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",gotpointercapture:"MSGotPointerCapture",lostpointercapture:"MSLostPointerCapture",maxTouchPoints:"msMaxTouchPoints"},o={update(){"undefined"!=typeof window&&("PointerEvent"in window?(o.hasApi=!0,o.requiresPrefix=!1):window.navigator&&"msPointerEnabled"in window.navigator?(o.hasApi=!0,o.requiresPrefix=!0):(o.hasApi=!1,o.requiresPrefix=void 0),o.maxTouchPoints=o.hasApi&&window.navigator&&window.navigator[o.prefix("maxTouchPoints")]||void 0,o.hasTouch=o.hasApi?o.maxTouchPoints>0:void 0)},prefix:t=>o.requiresPrefix&&e[t]||t};o.update();const i=(t,e)=>{let o,i=null;return function(){for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];i?o=n:(t.call(this,...n),i=setTimeout((()=>{o&&(t.call(this,...n),o=null),i=null}),e))}};(()=>{const t=new Map;new ResizeObserver(i((e=>{e.forEach((e=>{let{target:o}=e;const i=o.getBoundingClientRect();t.get(o).updateInnerHeightStyle(i.height)}))}),10))})();const s=Inputmask("+9 (999) 999-99-99"),n=(Inputmask("currency"),Inputmask({mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,63}]@-{1,63}.-{1,63}[.-{1,63}][.-{1,63}]",greedy:!1,onBeforePaste:function(t,e){return(t=t.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"},"-":{validator:"[0-9A-Za-z-]",cardinality:1,casing:"lower"}}}));TomSelect.define("linnikov_custom",(function(){this.hook("after","setup",(()=>{const t=document.createElement("span");t.classList.add("icon-nav-check-arrow","ts-state-indicator"),this.control.append(t)})),this.hook("after","open",(()=>{this.dropdown.classList.add("open"),this.dropdown.setAttribute("aria-hidden",!1)})),this.hook("after","close",(()=>{this.dropdown.classList.remove("open"),this.dropdown.setAttribute("aria-hidden",!0),this.blur()}))})),$.validator.addMethod("tel-or-email",(function(t,e){return $.validator.methods.email.call(this,t,e)||/\+?[\d- \(\)]/.test(t)})),$.validator.addMethod("custom-tel",(function(t,e){return s.isValid(t)})),$.validator.addMethod("custom-email",(function(t,e){return n.isValid(t)}));class r{constructor(e){this.activeElem=null,this.timer=null,this.dom={root:t(e)}}async show(t,e,o){this.activeElem&&this.activeElem.classList.remove("active"),this.timer&&clearTimeout(this.timer);const i=this.dom.root.querySelector('[data-type="'.concat(t,'"]'));if(i.textContent=e||i.getAttribute("data-default"),i.classList.add("active"),this.activeElem=i,this.dom.root.classList.add("showed"),o)return new Promise((t=>{this.timer=setTimeout((()=>{t(),this.hide()}),o)}))}hide(){this.activeElem&&this.activeElem.classList.remove("active"),this.dom.root.classList.remove("showed")}}class a{static initTomSelect(t){const e={controlInput:null,plugins:{linnikov_custom:{}}};t.hasAttribute("data-no-clear-btn")||(e.plugins.clear_button={title:"Remove selected item"}),new TomSelect(t,e)}constructor(e){this.dom={root:t(e)},this.dom.body=this.dom.root.querySelector("[data-elem=body]"),this.dom.tomSelects=this.dom.root.querySelectorAll("[data-component=tom-select]"),this.dom.submitBtn=this.dom.root.querySelector("[data-elem=submit-btn]");let o=this.dom.root.querySelector('[data-component="form-messages"]')||document.querySelector('[data-component="form-messages"][data-for="'.concat(this.dom.root.getAttribute("id"),'"]'));this.messages=new r(o),this.initTomSelects(),this.initValidator()}async submitHandler(){}initTomSelects(){this.dom.tomSelects.forEach((t=>{a.initTomSelect(t)}))}initValidator(){this.validator=$(this.dom.root).validate({ignore:[],highlight:function(t,e,o){$(t).closest(".form-field").addClass(e)},unhighlight:function(t,e,o){$(t).closest(".form-field").removeClass(e)},errorPlacement:function(t,e){t.appendTo(e.closest(".form-field"))},submitHandler:async(t,e)=>{e.preventDefault(),this.disableSubmitBtn(),this.showSubmitBtnSpiner();try{await this.submitHandler(t,e),this.reset()}catch(t){console.error("Error while submitting form query",t),this.showMessage("error",t.message,5e3)}finally{this.enableSubmitBtn()}}})}disableSubmitBtn(){this.dom.submitBtn&&(this.dom.submitBtn.disabled=!0)}enableSubmitBtn(){this.dom.submitBtn&&(this.dom.submitBtn.classList.remove("waiting"),this.dom.submitBtn.disabled=!1)}showSubmitBtnSpiner(){this.dom.submitBtn.classList.add("waiting")}hideSubmitBtnSpiner(){this.dom.submitBtn.classList.remove("waiting")}reset(){this.dom.root.reset(),this.enableSubmitBtn()}async showMessage(t,e,o){return await this.messages.show(t,e,o)}hideMessages(){this.messages.hide()}}class c extends a{constructor(t){super(t)}async submitHandler(t,e){e.preventDefault();const o=new FormData(t),i=await grecaptcha.execute("6LeySEgqAAAAAJPJdoC2slB0x-4BFIPaX4_pPTyO",{action:"submit_brief_form"});document.getElementById("g-recaptcha-response").value=i,o.append("g-recaptcha-response",i);const s=Array.from(t.querySelectorAll('input[name="project_types[]"]:checked')).map((t=>t.value)),n=Array.from(t.querySelectorAll('input[name="tools[]"]:checked')).map((t=>t.value));o.delete("project_types[]"),s.forEach((t=>o.append("project_types[]",t))),o.delete("tools[]"),n.forEach((t=>o.append("tools[]",t))),o.append("action","submit_designer_form"),o.append("nonce",ajax_designer_params.nonce),document.querySelectorAll(".form-msg").forEach((t=>t.textContent=""));try{const e=await fetch(ajax_designer_params.ajax_url,{method:"POST",body:o});if(!(await e.json()).success)throw new Error("Error (status: ".concat(e.status,") sending the form: ").concat(e.statusText));this.showMessage("success",null,5e3),t.reset()}catch(t){this.showMessage("error","An error occurred. Please try again.",5e3),console.error("Error:",t)}finally{this.hideSubmitBtnSpiner()}}}document.addEventListener("DOMContentLoaded",(function(){new c("#designer-application-form")}))})()})();