(()=>{"use strict";(()=>{function t(t){if(t instanceof Element||t===window)return t;{const e=document.querySelector(t);return e||new Error("Cannot find the target by selector: ".concat(t)),e}}Number.prototype.clamp=function(t,e){return Math.max(t,Math.min(this.valueOf(),e))};const e=function(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),o=1;o<e;o++)s[o-1]=arguments[o];return s.forEach((e=>{const s=[{target:t,src:e}];for(;s.length;){const{src:t,target:e}=s.shift();Object.keys(t).forEach((o=>{!i(t[o])||t[o]instanceof Array||!i(e[o])||e[o]instanceof Array?e[o]=t[o]:t[o]!==e[o]&&s.push({src:t[o],target:e[o]})}))}})),t};function i(t){return"object"==typeof t&&null!=t}const s={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerover:"MSPointerOver",pointerout:"MSPointerOut",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",gotpointercapture:"MSGotPointerCapture",lostpointercapture:"MSLostPointerCapture",maxTouchPoints:"msMaxTouchPoints"},o={update(){"undefined"!=typeof window&&("PointerEvent"in window?(o.hasApi=!0,o.requiresPrefix=!1):window.navigator&&"msPointerEnabled"in window.navigator?(o.hasApi=!0,o.requiresPrefix=!0):(o.hasApi=!1,o.requiresPrefix=void 0),o.maxTouchPoints=o.hasApi&&window.navigator&&window.navigator[o.prefix("maxTouchPoints")]||void 0,o.hasTouch=o.hasApi?o.maxTouchPoints>0:void 0)},prefix:t=>o.requiresPrefix&&s[t]||t};o.update();const n=(t,e)=>{let i,s=null;return function(){for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];s?i=n:(t.call(this,...n),s=setTimeout((()=>{i&&(t.call(this,...n),i=null),s=null}),e))}},r=(()=>{const t=new Map,e=new ResizeObserver(n((e=>{e.forEach((e=>{let{target:i}=e;const s=i.getBoundingClientRect();t.get(i).updateInnerHeightStyle(s.height)}))}),10));return{observe:(i,s)=>{t.set(s,i),e.observe(s)}}})();class a{constructor(e){this.dom={root:t(e)},this.dom.inner=this.dom.root.querySelector('[data-elem*="disclosure.inner"]'),this.dom.toggleBtns=Array.from(this.dom.root.querySelectorAll('[data-elem*="disclosure.toggle-btn"]')),this.dom.root.matches('[data-elem*="disclosure.toggle-btn"]')&&this.dom.toggleBtns.push(this.dom.root),this.dom.toggleBtns.forEach((t=>t.addEventListener("click",(()=>this.toggle(void 0,"trigger-click"))))),r.observe(this,this.dom.inner)}updateInnerHeightStyle(t){this.dom.root.style.setProperty("--inner-height","".concat(t,"px"))}toggle(t,e){null!=t?t?this.open(e):this.close(e):this.dom.root.classList.contains("open")?this.close(e):this.open(e)}open(t){this.dom.root.classList.add("open"),this.dom.toggleBtns.forEach((t=>t.classList.add("active"))),this.dom.root.dispatchEvent(new CustomEvent("disclosure.open",{detail:{self:this,reason:t},bubbles:!0}))}close(t){this.dom.root.classList.remove("open"),this.dom.toggleBtns.forEach((t=>t.classList.remove("active"))),this.dom.root.dispatchEvent(new CustomEvent("disclosure.close",{detail:{self:this,reason:t},bubbles:!0}))}}const c=Inputmask("+9 (999) 999-99-99"),d=(Inputmask("currency"),Inputmask({mask:"*{1,64}[.*{1,64}][.*{1,64}][.*{1,63}]@-{1,63}.-{1,63}[.-{1,63}][.-{1,63}]",greedy:!1,onBeforePaste:function(t,e){return(t=t.toLowerCase()).replace("mailto:","")},definitions:{"*":{validator:"[0-9A-Za-z!#$%&'*+/=?^_`{|}~-]",cardinality:1,casing:"lower"},"-":{validator:"[0-9A-Za-z-]",cardinality:1,casing:"lower"}}}));TomSelect.define("linnikov_custom",(function(){this.hook("after","setup",(()=>{const t=document.createElement("span");t.classList.add("icon-nav-check-arrow","ts-state-indicator"),this.control.append(t)})),this.hook("after","open",(()=>{this.dropdown.classList.add("open"),this.dropdown.setAttribute("aria-hidden",!1)})),this.hook("after","close",(()=>{this.dropdown.classList.remove("open"),this.dropdown.setAttribute("aria-hidden",!0),this.blur()}))})),$.validator.addMethod("tel-or-email",(function(t,e){return $.validator.methods.email.call(this,t,e)||/\+?[\d- \(\)]/.test(t)})),$.validator.addMethod("custom-tel",(function(t,e){return c.isValid(t)})),$.validator.addMethod("custom-email",(function(t,e){return d.isValid(t)}));class h{constructor(e){this.activeElem=null,this.timer=null,this.dom={root:t(e)}}async show(t,e,i){this.activeElem&&this.activeElem.classList.remove("active"),this.timer&&clearTimeout(this.timer);const s=this.dom.root.querySelector('[data-type="'.concat(t,'"]'));if(s.textContent=e||s.getAttribute("data-default"),s.classList.add("active"),this.activeElem=s,this.dom.root.classList.add("showed"),i)return new Promise((t=>{this.timer=setTimeout((()=>{t(),this.hide()}),i)}))}hide(){this.activeElem&&this.activeElem.classList.remove("active"),this.dom.root.classList.remove("showed")}}class l{static initTomSelect(t){const e={controlInput:null,plugins:{linnikov_custom:{}}};t.hasAttribute("data-no-clear-btn")||(e.plugins.clear_button={title:"Remove selected item"}),new TomSelect(t,e)}constructor(e){this.dom={root:t(e)},this.dom.body=this.dom.root.querySelector("[data-elem=body]"),this.dom.tomSelects=this.dom.root.querySelectorAll("[data-component=tom-select]"),this.dom.submitBtn=this.dom.root.querySelector("[data-elem=submit-btn]");let i=this.dom.root.querySelector('[data-component="form-messages"]')||document.querySelector('[data-component="form-messages"][data-for="'.concat(this.dom.root.getAttribute("id"),'"]'));this.messages=new h(i),this.initTomSelects(),this.initValidator()}async submitHandler(){}initTomSelects(){this.dom.tomSelects.forEach((t=>{l.initTomSelect(t)}))}initValidator(){this.validator=$(this.dom.root).validate({ignore:[],highlight:function(t,e,i){$(t).closest(".form-field").addClass(e)},unhighlight:function(t,e,i){$(t).closest(".form-field").removeClass(e)},errorPlacement:function(t,e){t.appendTo(e.closest(".form-field"))},submitHandler:async(t,e)=>{e.preventDefault(),this.disableSubmitBtn(),this.showSubmitBtnSpiner();try{await this.submitHandler(t,e),this.reset()}catch(t){console.error("Error while submitting form query",t),this.showMessage("error",t.message,5e3)}finally{this.enableSubmitBtn()}}})}disableSubmitBtn(){this.dom.submitBtn&&(this.dom.submitBtn.disabled=!0)}enableSubmitBtn(){this.dom.submitBtn&&(this.dom.submitBtn.classList.remove("waiting"),this.dom.submitBtn.disabled=!1)}showSubmitBtnSpiner(){this.dom.submitBtn.classList.add("waiting")}hideSubmitBtnSpiner(){this.dom.submitBtn.classList.remove("waiting")}reset(){this.dom.root.reset(),this.enableSubmitBtn()}async showMessage(t,e,i){return await this.messages.show(t,e,i)}hideMessages(){this.messages.hide()}}class u{constructor(e){this.dom={input:t(e)},this.dom.wrap=this.dom.input.closest(".form-field");try{this.disclosure=new a(this.dom.input.closest(".field-disclosure"))}catch(t){console.log("No disclosure for field",t)}}clear(){this.dom.input.value=null}setRequired(t){t?this.dom.input.setAttribute("required",!0):this.dom.input.removeAttribute("required")}setHidden(t){this.disclosure?this.disclosure.toggle(!t):t?this.dom.wrap.classList.add("_hidden"):this.dom.wrap.classList.remove("_hidden")}}class m extends l{constructor(t){super(t),this.categoryOtherDesc=new u(this.dom.root.querySelector('[name="category--other-desc"]')),this.sourceOtherDesc=new u(this.dom.root.querySelector('[name="source--other-desc"]')),this.deadlineDate=new u(this.dom.root.querySelector('[name="deadline-date"]')),this.initLogic()}initLogic(){this.dom.root.querySelector('[name="category[]"][value="Other"]').addEventListener("change",(t=>{let{target:e}=t;this.categoryOtherDesc.setHidden(!e.checked),this.categoryOtherDesc.setRequired(e.checked),e.checked||this.categoryOtherDesc.clear()})),this.dom.root.querySelector('[name="source[]"][value="Other"]').addEventListener("change",(t=>{let{target:e}=t;this.sourceOtherDesc.setHidden(!e.checked),this.sourceOtherDesc.setRequired(e.checked),e.checked||this.sourceOtherDesc.clear()})),this.dom.root.querySelector("#has-deadline-radioset").addEventListener("change",(t=>{let{target:e}=t;const i="Yes"===e.value;this.deadlineDate.setHidden(!i),this.deadlineDate.setRequired(i),i||this.deadlineDate.clear()}))}async submitHandler(t,e){const i=await new Promise((t=>setTimeout((()=>t({ok:!0})),1e3)));if(this.hideSubmitBtnSpiner(),i.ok)return this.showMessage("success",null,5e3);throw new Error("Error (status: ".concat(i.status,") sending the form: ").concat(i.statusText))}}const p={steps:5,labels:!1,breakpoints:{}};class v{constructor(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._hoveredSection=null,this._vars=e({},p),this.setOptions(s),this.dom={input:t(i)},this.update()}setOptions(t){arguments.length>1&&void 0!==arguments[1]&&!arguments[1]?this._vars=t:e(this._vars,t),this.initialized&&this.update()}update(){this.initialized&&this.destruct(),this.initBreakpoints(),this.readInputAttributes(),this.recalcSectionSize(),this.updateDom(),this.alignStep(),this.initActions(),this.hasLabels=Boolean(this._vars.labels),this.initialized=!0}recalcSectionSize(){this._sectionSize=this._size/(this.getVar("steps")-1)}initBreakpoints(){for(var t in this._mediaQueries=[],this._vars.breakpoints){const e=matchMedia(t);this._mediaQueries.push(e),e.onchange=t=>this.onMediaChange(t),this.onMediaChange(e)}}onMediaChange(t){let{matches:e,media:i}=t;this.activeMedia=null,e&&(this.activeMedia=i),this.initialized&&this.update()}readInputAttributes(){this._min=Number(this.dom.input.getAttribute("min")||0),this._max=Number(this.dom.input.getAttribute("max")||100),this._size=this._max-this._min}set activeMedia(t){this._activeMedia=t}get activeMedia(){return this._activeMedia}set hasLabels(t){var e;this._hasLabels=t,null===(e=this.dom.root)||void 0===e||e.classList.toggle("_has-labels",t)}get hasLabels(){return this._hasLabels}set initialized(t){var e;this._initialized=t,null===(e=this.dom.root)||void 0===e||e.classList.toggle("_initialized",t)}get initialized(){return this._initialized}set hoveredSection(t){this._hoveredSection=t,this.updateThumbPosition()}get hoveredSection(){return this._hoveredSection}set activeStep(t){var e,i;console.log("Setting active step to: ".concat(t)),console.log("Previous active step: ".concat(this._activeStep)),null===(e=this.dom.sections[this._activeStep])||void 0===e||e.classList.remove("_selected"),this._activeStep=t,null===(i=this.dom.sections[t])||void 0===i||i.classList.add("_selected"),this.value=this.getStepValue(t),this.updateThumbPosition(),console.log("Active step successfully set to: ".concat(this._activeStep)),console.log("New value: ".concat(this.value))}get activeStep(){return this._activeStep}set value(t){this.dom.input.value=t,this.dom.input.dispatchEvent(new Event("change",{bubbles:!0}))}get value(){return this.dom.input.value}destruct(){this.dom.root.replaceWith(this.dom.input),this._mediaQueries.forEach((t=>t.onchange=null)),this._mediaQueries=null,this.initialized=!1}getStepValue(t){const e=this.getVar("getStepValue");return e?e(t,self):(()=>this._min+this._sectionSize*t)()}renderLabel(t){var e;return"string"==typeof this._vars.labels?e=this._vars.labels.replace("{value}",this.getStepValue(t)):"boolean"==typeof this._vars.labels?e=this.getStepValue(t):this._vars.labels instanceof Array?e=this._vars.labels[t]:this._vars.labels instanceof Function&&(e=this._vars.labels(t,this.getStepValue(t))),'<div class="range-input-div__label">'.concat(e,"</div>")}renderSection(t){return'<div data-idx="'.concat(t,'" data-active="true" class="range-input-div range-input__div">\n\t\t\t\t\t\t\t<div class="range-input-div__inner">\n\t\t\t\t\t\t\t\t<div class="range-input-div__mark"></div>\n\t\t\t\t\t\t\t\t').concat(this._vars.labels?this.renderLabel(t):"","\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>")}getVar(t){const e=this._vars.breakpoints&&this._activeMedia?this._vars.breakpoints[this._activeMedia]:{};return t in e?e[t]:this._vars[t]}updateDom(){this.dom.root=document.createElement("div"),this.dom.root.classList.add("range-input"),this.sectionsNumber=this.getVar("steps")-1;const t=[];for(var e=0;e<this.getVar("steps");e++)t.push(this.renderSection(e));this.dom.root.innerHTML='<div class="range-input__body"><div class="range-input__inner">'.concat(t.join(""),"</div></div>"),this.dom.sections=Array.from(this.dom.root.querySelectorAll(".range-input-div")),this.dom.root.style.setProperty("--sections-number",this.getVar("steps")-1),this.dom.root.style.setProperty("--inner-marks",this.getVar("steps")-2),this.dom.input.replaceWith(this.dom.root),this.dom.root.append(this.dom.input)}initActions(){this.dom.root.addEventListener("click",(t=>{let{target:e}=t;if(!e.matches(".range-input-div, .range-input-div *"))return;const i=e.closest(".range-input-div");this.activeStep=Number(i.getAttribute("data-idx"))})),app.state.isMobile||this.bindHoverTracking()}bindHoverTracking(){this.dom.sections.forEach(((t,e)=>{t.addEventListener("".concat(app.state.pointerType,"leave"),(()=>this.hoveredSection=null)),t.addEventListener("".concat(app.state.pointerType,"enter"),(()=>this.hoveredSection=e))}))}getStepFromValue(t){return Math.round((t-this._min)/this._sectionSize)}alignStep(){var t=this.dom.input.value;this.activeStep=this.getStepFromValue(t)}updateThumbPosition(){null!==this._hoveredSection?this.setThumbPosition(this._hoveredSection):this.setThumbPosition(this._activeStep)}setThumbPosition(t){this.dom.root.style.setProperty("--thumb-position",t)}}document.addEventListener("DOMContentLoaded",(function(){(function(){const t={steps:10,breakpoints:{"(max-width: 768px)":{steps:5}}};document.querySelectorAll("#identification-chars input[type=range]").forEach((e=>new v(e,t)))})(),new m("#brief-form")}))})()})();